## Usage

In this chapter I want to give you an overall idea of how to send payloads to the Slack API, accessing the methods
that it has made available.

To do this, I'm going to be using an example scenario where I want to send a message to Slack, which is probably the 
scenario that drove you to this package in the first place (am I right :smile:?). So let's get slacking:
 

### Sending a payload to Slack (in this case: chat.postMessage)

Most likely you will just want to send some messages to one of your Slack channels, so here's how you do it:

First, we need to construct the client that will be communicating with the Slack API. To do this you will be using the 
API token that you should have generated by now. 

*NOTE: If you haven't created your own API token yet, check out the [Getting Started](getting-started.md) doc to do so now.*

```php
// construct the client object
$apiClient = new ApiClient('your-slack-token-here');
```

Every method that the Slack API provides has been converted into a special `payload`-class. This is because not every
method requires the same data, and some methods even send data back. For sending a message, this class is aptly called the 
`ChatPostMessagePayload` class. 

Now, having constructed the `ApiClient` object as indicated above, it's time to construct the payload for sending the actual message:
```php
// construct the payload
$payload = new ChatPostMessagePayload();
$payload->setChannel('#general');
$payload->setMessage('Hello world!');
```

All that's left to do now is to send the payload we created. This is very simple as well:
```php
$response = $apiClient->send($payload);
```

That's it! If you provided a valid token and used the instructions above, there should not be a message `Hello World!` posted 
in the `#general` of your team's Slack instance. If this did not happen, check out the instructions for handling errors below.

*HINT:* Although the setters and getters are different of each payload, they all get sent to the API this way.


### Handling errors

If for some reason the message wasn't sent, you can check out what went wrong by catching the error. An example of this 
can be found below:

```php
if ($response->isOk()) {
    // raise the roof! the message has been successfully posted on your Slack channel!
    $response->getTimestamp()) // access a value from the Slack response
} else {
    // perhaps check out what went wrong?
    die($response->getErrorExplanation());
    
    // or (cleaner imo):
    throw new \Exception(sprintf('Couldn't send message to Slack (%s): %s', $response->getError(), $response->getErrorExplanation()));
}
```
